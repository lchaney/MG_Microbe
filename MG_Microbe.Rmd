---
title: "MG_Microbe"
author: "Lindsay Chaney"
date: "August 17, 2015"
output: html_document
---

####Pre-Analysis Data Cleaning
Prior to loading, data was cleaned as follows:

* removed genotype 20 because it was not planted in all treatments  
* removed plants that never flowered: 10-2-1   5-3-1   12-1-3  
* deleted no germination, dead for any reason, wrong color in an inbred line
    + removed 53 that died  
    + removed 82 that did not germinate  
    + removed 6 that were not correct color for line  

*this is essentially the tab 'Gina_man_deleteng' with no flowering removed*  

***
####Experimental details
Greenhouse experiment:

* 4 treatments: Field Soil (3), Autoclave (4), Autoclave Inoculum (2), Autoclave Antibiotic (1)
* 20 genotypes (maternal lines) with 6 replicates each
* 3 Flower colors: Pink, Purple and White

***
```{r run, echo = FALSE, warning = FALSE, error = FALSE, message = FALSE, fig.keep='none'}
source('Analysis/04_Do.R')
```

##Data Exploration
We have a lot of variables, but we don't want to test them all. Let us see if we
can narrow down our focus.

Here is a raw list of variables --
```{r}
names(mgdat)
```

Are these traits correlated?

```{r corplots, echo=FALSE, warning=FALSE, cache=TRUE}
  corrPlot2(mgdat[samplevars])
  corrPlot2(mgdat[flowvars])
  corrPlot2(mgdat[leafsumvars])
  corrPlot2(mgdat[leafnumvars])
  corrPlot2(mgdat[heightvars])
```

Do there appear to be patterns in the data?

```{r boxplots, echo=FALSE, results='hide', warning=FALSE, cache=TRUE}
  lapply(flowvars, gxe_potgrid2)
  lapply(leafsumvars, gxe_potgrid2)
  lapply(leafnumvars, gxe_potgrid2)
  lapply(heightvars, gxe_potgrid2)
```

Test for flower color?

```{r colboxplots, echo=FALSE, results='hide', warning=FALSE, cache=TRUE}
  lapply(samplevars, colplot)
```

From these, I am going to focus on the following variables: DOFF, SumFlowering 
(proxy for fitness), LeafSum34 (biomass at day 34), and HeightRGRC (height growth -- day 34-14/20)

##Test for differences by G, E, and GxE

Day of first flower:

```{r, DOFF_GE, echo = TRUE}
  anova(fit1)
  rand(fit1)
```

Total number of flowers

```{r, Sum_GE, echo = TRUE}
   anova(fit4)
   rand(fit4)
   summary(glht(fit4, linfct = mcp(Treatment = "Tukey"))) #post hoc Tukey's with MultComp
```

Biomass or Sum of Leaf Lengths *LATE*

```{r, LeafSum34_GE, echo = TRUE}
    fit7 <- lmer(LeafSum34 ~ Treatment + (1 | Genotype) + (1 | Genotype:Treatment), data = mgdat)
      anova(fit7)
        rand(fit7)
        summary(glht(fit7, linfct = mcp(Treatment = "Tukey"))) #post hoc Tukey's with MultComp
```

Growth

```{r, HeightRGRC, echo = TRUE}
      anova(fit37)
         rand(fit37)
         summary(glht(fit37, linfct = mcp(Treatment = "Tukey"))) #post hoc Tukey's with MultComp
```

Summary of mean trait values and standard error of the mean

```{r, traitmeans, echo = TRUE}
trait_summary
```


