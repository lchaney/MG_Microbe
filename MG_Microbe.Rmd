---
title: "MG_Microbe"
author: "Lindsay Chaney"
date: "August 17, 2015"
output: html_document
---

####Pre-Analysis Data Cleaning
Prior to loading, data was cleaned as follows:

* removed genotype 20 because it was not planted in all treatments  
* removed plants that never flowered: 10-2-1   5-3-1   12-1-3  
* deleted no germination, dead for any reason, wrong color in an inbred line
    + removed 53 that died  
    + removed 82 that did not germinate  
    + removed 6 that were not correct color for line  

*this is essentially the tab 'Gina_man_deleteng' with no flowering removed*  

***
####Experimental details
Greenhouse experiment:

* 4 treatments: Field Soil (3), Autoclave (4), Autoclave Inoculum (2), Autoclave Antibiotic (1)
* 20 genotypes (maternal lines) with 6 replicates each
* 3 Flower colors: Pink, Purple and White

***
```{r run, echo = FALSE, warning = FALSE, error = FALSE, message = FALSE, fig.keep='none'}
source('Analysis/04_Do.R')
```

##Data Exploration

Full data exploration is not shown.

Traits I am going to focus on the following variables: DOFF, SumFlowering 
(proxy for fitness), LeafSum34 (biomass at day 34), and HeightRGRC (height growth -- day 34-14/20)

Only going to focus on Autoclave and Inoculm treatments (Field and Autoclave as a supplement)

##Test for differences by G, E, and GxE

###DOFF

Day of first flower:

```{r, DOFF_GE, echo = FALSE}
  anova(fit1)
  rand(fit1)
```

###SumFlowers

Total number of flowers

```{r, Sum_GE, echo = FALSE}
   anova(fit4)
   rand(fit4)
```

###LeafSum34

Biomass or Sum of Leaf Lengths *LATE*

```{r, LeafSum34_GE, echo = FALSE}
      anova(fit7)
      rand(fit7)
```

###HeightRGRC

Growth

```{r, HeightRGRC_GE, echo = FALSE}
      anova(fit37)
         rand(fit37)
``` 

####Trait Means

Summary of mean trait values and standard error of the mean

```{r, traitmeans, echo = FALSE}
trait_summary
```

```{r, plottraitmeans, echo = FALSE}
gebox
#gevio
#gedot
#gebar
```         

##Selection Differential; Total Selection; Direct and Indirect Selection (Univariate Analysis)

*looking at y~x is the same as cor(x,y) if the varaviles have equal standard deviations and equal variances -- both give strenght of linear relationship, but cor is bounded by 1 and reg can tell change in y*

* Relative fitness was used
* Traits are standardized to mean of 0 variance of 1 (z-score)
* Genotype line means reduces influence of environmental covariants

###DOFF

Day of first flower:

```{r, DOFF_TS, echo = FALSE}
    anova(ts.doff)
    summary(ts.doff)
```

###LeafSum34

Biomass at day 34

```{r, LeafSum34_TS, echo = FALSE}
    anova(ts.lvsum)
    summary(ts.lvsum)
```

###HeightRGRC

Growth

```{r, HeightRGRC_TS, echo = FALSE}
    anova(ts.grw)
    summary(ts.grw)
```


##Differences in Selection Differentials by treatment

To test for differences in selection by treatment, an ANCOVA was performed. A significant interaction between trait and treatment indicate that the direction and/or intensity of selection differed.

###Selection Differential - ANCOVA

```{r, sd ancova, echo = FALSE}
    anova(asd.doff)
    anova(asd.grw)
    anova(asd.lsum)
```

What are the selection differentials in each treatment?

```{r, sd.treat}
    ts.doff.treat
    ts.grw.treat
    ts.lvsum.treat
```

Plot selection differentials for each trait and treatment

```{r, sd.treatplot, echo = FALSE}
grid.arrange(arrangeGrob(ts.doffplot, ts.lvsumplot, ts.grwplot, nrow = 3))
```

##Selection Gradient; Direct Selection (mulitvariate analysis)

Linear selection -- estimated in models containing only the linear terms. 

```{r, ds, echo = FALSE}
    anova(ds.mod)
    summary(ds.mod)
```
    
Quadratic selection -- estimated in a full model that contained linear terms, quadratic terms, and cross-product terms of focal traits. Quadratic regression coefficients will need to be converted to selection gradients by doubling them and their respective standard errors.

```{r, dsquad, echo = FALSE}
    anova(dsquad.mod)
    summary(dsquad.mod) 
```

Is quadratic selection for Flowering day just curvey or is there a fitness maximum/minimum?

```{r, doffqaud, echo = FALSE}
  doff.quad
```



##Differences in Selection Gradients by treatment

To test for differences in selection by treatment, an ANCOVA was performed. A significant interaction between trait and treatment indicate that the direction and/or intensity of selection differed.

###Selection Gradient - ANCOVA

```{r, sg ancova, echo = FALSE}
    anova(asgl)
    anova(asgq)
```

What are the betas for each of the treatments?

```{r, ds treat, echo = FALSE}
  asgl.treat
```

Plot of different selection on flowering time for treatment

```{r, doff treat, echo=FALSE}
  ts.doffplot
```

What are the gammas for each of the treatments?

```{r, dsquad treat, echo=FALSE}
    asgq.treat
```

Difference in joint selection of Flowering Time and Growth by Treatment

```{r,sg surface treat, echo = FALSE}
    grid.arrange(arrangeGrob(FSsurface.inoculum, FSsurface.autoclave, nrow = 2))
```
